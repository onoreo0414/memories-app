<form id="memoryForm">
  <input type="date" name="date" required />
  <input type="text" name="title" placeholder="出来事" required />
  <textarea name="message" placeholder="メッセージ"></textarea>
  <select name="author" required>
    <option value="れお">れお</option>
    <option value="ひまり">ひまり</option>
  </select>
  <select name="category" required>
    <option value="約束">約束</option>
    <option value="ありがとう">ありがとう</option>
    <option value="おめでとう">おめでとう</option>
    <option value="ごめんなさい">ごめんなさい</option>
  </select>
  <button type="submit">投稿</button>
</form>

<div id="memoryList"></div>

<style>
  body { font-family: sans-serif; padding: 10px; background: #f7f7f7; }
  .category-group { margin-bottom: 15px; }
  .category-title { font-weight: bold; cursor: pointer; padding: 5px; }
  .memory-card { background: #fff; padding: 10px; margin: 5px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  .category-約束        { border-left: 4px solid #1E90FF; }   /* 約束：落ち着いた青 */
  .category-ありがとう  { border-left: 4px solid #32CD32; }   /* ありがとう：爽やかな緑 */
  .category-おめでとう  { border-left: 4px solid #FFD700; }   /* おめでとう：ゴールドで祝福感 */
  .category-ごめんなさい{ border-left: 4px solid #FF4500; }   /* ごめんなさい：強めの赤で注意感 */
</style>

<script>
async function loadMemories() {
  let res = await fetch('/api/memories');
  let data = await res.json();

  // カテゴリーごとにグループ化
  let grouped = {};
  data.forEach(m => {
    if (!grouped[m.category]) grouped[m.category] = [];
    grouped[m.category].push(m);
  });

  // HTML生成
  document.getElementById("memoryList").innerHTML = Object.keys(grouped).map(cat => `
    <div class="category-group">
      <div class="category-title" onclick="this.nextElementSibling.classList.toggle('hidden')">${cat}</div>
      <div class="category-items">
        ${grouped[cat].map(m => `
          <div class="memory-card category-${cat}">
            <b>${m.date} - ${m.title}</b><br>
            ${m.message}<br>
            <i>by ${m.author}</i>
          </div>
        `).join('')}
      </div>
    </div>
  `).join('');
}

loadMemories();
</script>
