<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ€ã„å‡ºã‚¢ãƒ—ãƒª</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1>æ€ã„å‡ºã‚’å…±æœ‰ã—ã‚ˆã†ï¼</h1>

<form id="memoryForm">
  <input type="date" name="date" required />
  <input type="text" name="title" placeholder="å‡ºæ¥äº‹" required />
  <textarea name="message" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"></textarea>
  <select name="author">
    <option value="ã‚ŒãŠ">ã‚ŒãŠ</option>
    <option value="ã²ã¾ã‚Š">ã²ã¾ã‚Š</option>
  </select>
  <select name="category" required>
    <option value="ãƒ«ãƒ¼ãƒ«">ãƒ«ãƒ¼ãƒ«</option>
    <option value="ã‚ã‚ŠãŒã¨ã†">ã‚ã‚ŠãŒã¨ã†</option>
    <option value="ãŠã‚ã§ã¨ã†">ãŠã‚ã§ã¨ã†</option>
    <option value="ã”ã‚ã‚“ãªã•ã„">ã”ã‚ã‚“ãªã•ã„</option>
  </select>
  <button type="submit">æŠ•ç¨¿</button>
</form>

<h2>ã‚«ãƒ†ã‚´ãƒªä¸€è¦§</h2>
<ul id="categoryLinks">
  <li><a href="category.html?cat=ãƒ«ãƒ¼ãƒ«">ãƒ«ãƒ¼ãƒ«</a></li>
  <li><a href="category.html?cat=ã‚ã‚ŠãŒã¨ã†">ã‚ã‚ŠãŒã¨ã†</a></li>
  <li><a href="category.html?cat=ãŠã‚ã§ã¨ã†">ãŠã‚ã§ã¨ã†</a></li>
  <li><a href="category.html?cat=ã”ã‚ã‚“ãªã•ã„">ã”ã‚ã‚“ãªã•ã„</a></li>
</ul>

<!-- ğŸ”¹ Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDgOOxvkvnel579hnfF8DU508XKTZyj3cw",
    authDomain: "memories-share-a44a2.firebaseapp.com",
    projectId: "memories-share-a44a2",
    storageBucket: "memories-share-a44a2.firebasestorage.app",
    messagingSenderId: "868430924607",
    appId: "1:868430924607:web:e93eb36867bb76a2d1618a",
    measurementId: "G-4H5D3VHPSG"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ğŸ”¹ Firestore ã«æŠ•ç¨¿ä¿å­˜
  document.getElementById('memoryForm').addEventListener('submit', async e => {
    e.preventDefault();
    const form = e.target;

    const memory = {
      date: form.date.value,
      title: form.title.value,
      message: form.message.value,
      author: form.author.value,
      category: form.category.value,
      createdAt: new Date()
    };

    try {
      await addDoc(collection(db, "memories"), memory);
      alert("æŠ•ç¨¿ã—ã¾ã—ãŸï¼");
      form.reset();
    } catch (error) {
      console.error("ä¿å­˜ã‚¨ãƒ©ãƒ¼:", error);
      alert("æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
    }
  });
</script>
</body>
</html>
