<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤º</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1 id="categoryTitle"></h1>
<button onclick="location.href='index.html'">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹</button>

<div id="memoryList"></div>

<script>
const params = new URLSearchParams(window.location.search);
const category = params.get('cat');
document.getElementById('categoryTitle').innerText = category + "ã®æ€ã„å‡º";

// ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
function loadMemories() {
  const data = JSON.parse(localStorage.getItem('memories') || '[]');
  const filtered = data.filter(m => m.category.trim() === category.trim());

  if (filtered.length === 0) {
    document.getElementById('memoryList').innerHTML = "<p>ã“ã®ã‚«ãƒ†ã‚´ãƒªã®æŠ•ç¨¿ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
    return;
  }

  const html = filtered.map(m => `
    <div class="memory-item category-${sanitizeCategory(m.category)}">
      <div class="memory-date">ğŸ“… ${m.date}</div>
      <div class="memory-title">ğŸ“ ${m.title}</div>
      <div class="memory-message">${m.message}</div>
      <div class="memory-author">ğŸ‘¤ by ${m.author}</div>
      <button onclick="deleteMemory(${m.id})">å‰Šé™¤</button>
    </div>
  `).join('');

  document.getElementById('memoryList').innerHTML = html;
}

// å®‰å…¨ãªã‚¯ãƒ©ã‚¹åã«å¤‰æ›
function sanitizeCategory(cat) {
  return encodeURIComponent(cat);
}

// æŠ•ç¨¿å‰Šé™¤
function deleteMemory(id) {
  let data = JSON.parse(localStorage.getItem('memories') || '[]');
  data = data.filter(m => m.id !== id);
  localStorage.setItem('memories', JSON.stringify(data));
  loadMemories();
}

loadMemories();
</script>
</body>
</html>
